<!DOCTYPE html>
<!-- saved from url=(0085)https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" style="min-height: 100%;" class="js csstransforms3d csstransitions gr__machinelearningmastery_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./drop_out_files/submit"></script><script type="text/javascript" src="./drop_out_files/form"></script><script type="text/javascript" src="./drop_out_files/form(1)"></script><script type="text/javascript" src="./drop_out_files/form(2)"></script>

<title>Dropout Regularization in Deep Learning Models With Keras - Machine Learning Mastery</title>

<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v7.2 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
<link rel="publisher" href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Dropout Regularization in Deep Learning Models With Keras - Machine Learning Mastery">
<meta property="og:description" content="A simple and powerful regularization technique for neural networks and deep learning models is dropout. In this post you will discover the dropout regularization technique and how to apply it to your models in Python with Keras. After reading this post you will know: How the dropout regularization technique works. How to use dropout on …">
<meta property="og:url" content="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/">
<meta property="article:author" content="https://www.facebook.com/jason.brownlee.39">
<meta property="article:section" content="Deep Learning">
<meta property="article:published_time" content="2016-06-20T05:00:37+10:00">
<meta property="article:modified_time" content="2017-03-31T08:42:55+10:00">
<meta property="og:updated_time" content="2017-03-31T08:42:55+10:00">
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Dropout-Regularization-in-Deep-Learning-Models-With-Keras.jpg">
<meta property="og:image:secure_url" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Dropout-Regularization-in-Deep-Learning-Models-With-Keras.jpg">
<meta property="og:image:width" content="640">
<meta property="og:image:height" content="425">
<script type="text/javascript" async="" src="./drop_out_files/9556588.js"></script><script src="./drop_out_files/296263687421164" async=""></script><script async="" src="./drop_out_files/fbevents.js"></script><script async="" src="./drop_out_files/analytics.js"></script><script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Dropout Regularization in Deep Learning Models With Keras Comments Feed" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.5"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./drop_out_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./drop_out_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./drop_out_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./drop_out_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./drop_out_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-font-awesome-css" href="./drop_out_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="apss-font-opensans-css" href="./drop_out_files/css" type="text/css" media="all">
<link rel="stylesheet" id="apss-frontend-css-css" href="./drop_out_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="./drop_out_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="./drop_out_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./drop_out_files/jquery.js"></script>
<script type="text/javascript" src="./drop_out_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./drop_out_files/crayon.min.js"></script>
<script type="text/javascript" src="./drop_out_files/third-party.min.js"></script>
<script type="text/javascript" src="./drop_out_files/modernizr.min.js"></script>
<script type="text/javascript" src="./drop_out_files/general.min.js"></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=2580">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fdropout-regularization-deep-learning-models-keras%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fdropout-regularization-deep-learning-models-keras%2F&amp;format=xml">
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');

fbq('init', '296263687421164');
fbq('track', "PageView");</script>
<noscript>&lt;img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=296263687421164&amp;ev=PageView&amp;noscript=1"
/&gt;</noscript>
<!-- End Facebook Pixel Code -->

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em Helvetica Neue, Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em Helvetica Neue, Helvetica, sans-serif;color:#999999;}
body, p { font:300 14px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:300 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em &quot;Helvetica Neue&quot;, Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:300 14px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#666666; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#666666;}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em Helvetica Neue, Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em Helvetica Neue, Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Woo Shortcodes CSS -->
<link href="./drop_out_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="./drop_out_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="./drop_out_files/can-i-show.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">
  /* === Form-Specific Styles === */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(9,123,156) !important;
    background: rgba(9,123,156,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

</style></head>
<body class="post-template-default single single-post postid-2580 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960" data-gr-c-s-loaded="true">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="./drop_out_files/MachineLearningMastery.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-3" class="widget widget_text">			<div class="textwidget"><br>
<div style="font-size:12pt;">
<a href="https://machinelearningmastery.com/start-here"><strong>Start Here</strong></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/blog">Blog</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/products">Books</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/about">About</a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/contact">Contact</a>
</div></div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div><div id="text-32" class="widget widget_text">			<div class="textwidget"><p>Need help with Deep Learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
		</div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Empty Menu</h3>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-2580 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
	<header>
	<h1 class="title entry-title">Dropout Regularization in Deep Learning Models With Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-20T05:00:37+1000">June 20, 2016</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span>  </div>
	<section class="entry">
<div class="apss-social-share apss-theme-4 clearfix">


				<div class="apss-twitter apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://twitter.com/intent/tweet?text=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fdropout-regularization-deep-learning-models-keras%2F&amp;&#39;);" href="javascript:void(0);" title="Share on Twitter" target="">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-twitter"></i>
							<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
						</div>
											</a>
				</div>
								<div class="apss-facebook apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&#39;);" title="Share on Facebook" target="" href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-facebook"></i>
							<span class="apss-social-text">Share on Facebook</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				
				<div class="apss-linkedin apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;http://www.linkedin.com/shareArticle?mini=true&amp;title=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&amp;summary=A+simple+and+powerful+regularization+technique+for+neural+networks+and+deep+learning+models+is+dropo...&#39;);" title="Share on LinkedIn" target="" href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&amp;summary=A+simple+and+powerful+regularization+technique+for+neural+networks+and+deep+learning+models+is+dropo...">
						<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
							<span class="apss-social-text">Share on LinkedIn</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
								<div class="apss-google-plus apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://plus.google.com/share?url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&#39;);" title="Share on Google Plus" target="" href="https://plus.google.com/share?url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-google-plus"></i>
							<span class="apss-social-text">Share on Google Plus</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				</div><p>A simple and powerful regularization technique for neural networks and deep learning models is dropout.</p>
<p>In this post you will discover the dropout regularization technique and how to apply it to your models in Python with Keras.</p>
<p>After reading this post you will know:</p>
<ul>
<li>How the dropout regularization technique works.</li>
<li>How to use dropout on your input layers.</li>
<li>How to use dropout on your hidden layers.</li>
<li>How to tune the dropout level on your problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0, TensorFlow 0.10.0 and scikit-learn v0.18.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<div id="attachment_2609" style="width: 650px" class="wp-caption aligncenter"><img class="size-full wp-image-2609" src="./drop_out_files/Dropout-Regularization-in-Deep-Learning-Models-With-Keras.jpg" alt="Dropout Regularization in Deep Learning Models With Keras" width="640" height="425" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Dropout-Regularization-in-Deep-Learning-Models-With-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Dropout-Regularization-in-Deep-Learning-Models-With-Keras-300x199.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p class="wp-caption-text">Dropout Regularization in Deep Learning Models With Keras<br>Photo by <a href="https://www.flickr.com/photos/trekkingrinjani/4930552641/">Trekking Rinjani</a>, some rights reserved.</p></div>
<h2>Dropout Regularization For Neural Networks</h2>
<p>Dropout is a regularization technique for neural network models proposed by Srivastava, et al. in their 2014 paper <a href="http://jmlr.org/papers/v15/srivastava14a.html">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a>&nbsp;(<a href="http://jmlr.org/papers/volume15/srivastava14a/srivastava14a.pdf">download the PDF</a>).</p>
<p>Dropout is a technique where randomly selected neurons are ignored during training. They are “dropped-out” randomly. This means that their contribution to the activation of downstream neurons is temporally removed on the forward pass and any weight updates are not applied to the neuron on the backward pass.</p>
<p>As a neural network learns, neuron weights settle into their context within the network. Weights of neurons are tuned for specific features providing some specialization. Neighboring neurons become to rely on this specialization, which if taken too far can result in a fragile model too specialized to the training data. This reliant on context for a neuron during training is referred to complex co-adaptations.</p>
<p>You can imagine that if neurons are randomly dropped out of the network during training, that other neurons will have to step in and handle the representation required to make predictions for the missing neurons. This is believed to result in multiple independent internal representations being learned by the network.</p>
<p>The effect is that the network becomes less sensitive to the specific weights of neurons. This in turn results in a network that is capable of better generalization&nbsp;and is less likely to overfit the training data.</p>
<!-- Start shortcoder --><p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with sample code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" target="_blank" rel="noopener" data-leadbox="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-leadbox-id="142d6e873f72a2:164f8be4f346dc">Start Your FREE Mini-Course Now!</a> <script src="./drop_out_files/leadbox-1463166699.js" type="text/javascript" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-config="%7B%7D"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><p></p><!-- End shortcoder v4.1.6-->
<h2>Dropout Regularization&nbsp;in Keras</h2>
<p>Dropout is easily implemented by randomly selecting nodes to be dropped-out with a given probability (e.g. 20%) each weight update cycle. This is how Dropout is implemented in Keras. Dropout is only used during the training of a model and is not used when evaluating the skill of the model.</p>
<p>Next we will explore a few different ways of using Dropout in Keras.</p>
<p>The examples will use the <a href="http://archive.ics.uci.edu/ml/datasets/Connectionist+Bench+(Sonar,+Mines+vs.+Rocks)">Sonar dataset</a>. This is a binary classification problem where the objective is to correctly identify rocks and mock-mines from sonar chirp returns. It is a good test dataset for neural networks because all of the input values are numerical and have the same scale.</p>
<p>The dataset can be <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/undocumented/connectionist-bench/sonar/sonar.all-data">downloaded from the UCI Machine Learning repository</a>. You can place the sonar dataset in your current working directory with the file name sonar.csv.</p>
<p>We will evaluate the developed models using scikit-learn with 10-fold cross validation, in order to better tease out differences in the results.</p>
<p>There are 60 input values and a single output value and the input values are standardized before being used in the network. The baseline neural network model has two hidden layers, the first with 60 units and the second with 30. Stochastic gradient descent is used to train the model with a relatively low learning rate and momentum.</p>
<p>The the full baseline model is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a8717688399242" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Baseline Model on the Sonar Dataset
import numpy
from pandas import read_csv
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from keras.wrappers.scikit_learn import KerasClassifier
from keras.constraints import maxnorm
from keras.optimizers import SGD
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import StratifiedKFold
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataframe = read_csv("sonar.csv", header=None)
dataset = dataframe.values
# split into input (X) and output (Y) variables
X = dataset[:,0:60].astype(float)
Y = dataset[:,60]
# encode class values as integers
encoder = LabelEncoder()
encoder.fit(Y)
encoded_Y = encoder.transform(Y)

# baseline
def create_baseline():
	# create model
	model = Sequential()
	model.add(Dense(60, input_dim=60, kernel_initializer='normal', activation='relu'))
	model.add(Dense(30, kernel_initializer='normal', activation='relu'))
	model.add(Dense(1, kernel_initializer='normal', activation='sigmoid'))
	# Compile model
	sgd = SGD(lr=0.01, momentum=0.8, decay=0.0, nesterov=False)
	model.compile(loss='binary_crossentropy', optimizer=sgd, metrics=['accuracy'])
	return model

numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasClassifier(build_fn=create_baseline, epochs=300, batch_size=16, verbose=0)))
pipeline = Pipeline(estimators)
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)
results = cross_val_score(pipeline, X, encoded_Y, cv=kfold)
print("Baseline: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-2">2</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-4">4</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-6">6</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-8">8</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-10">10</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-12">12</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-14">14</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-16">16</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-18">18</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-20">20</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-22">22</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-24">24</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-26">26</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-28">28</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-30">30</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-32">32</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-34">34</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-36">36</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-38">38</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-40">40</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-42">42</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-44">44</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-46">46</div><div class="crayon-num" data-line="crayon-5ac9e983a8717688399242-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8717688399242-48">48</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a8717688399242-1"><span class="crayon-p"># Baseline Model on the Sonar Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">constraints </span><span class="crayon-e">import </span><span class="crayon-e">maxnorm</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">SGD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">StratifiedKFold</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-v">Pipeline</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-15"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-16"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-17"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-18"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-19"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"sonar.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">values</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-21"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">60</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-t">float</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-23"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">60</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-24"><span class="crayon-p"># encode class values as integers</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-25"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-26"><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-27"><span class="crayon-v">encoded_Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-28">&nbsp;</div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-29"><span class="crayon-p"># baseline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-30"><span class="crayon-e">def </span><span class="crayon-e">create_baseline</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-31"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-32"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-33"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-34"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-35"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-36"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-37"><span class="crayon-h">	</span><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decay</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nesterov</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-38"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-39"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-40">&nbsp;</div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-41"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-42"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-43"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-44"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_baseline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-45"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-46"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StratifiedKFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8717688399242-47"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoded_Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8717688399242-48"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Baseline: %.2f%% (%.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>Running the example generates an estimated classification accuracy of 86%.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a8722042522559" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Baseline: 86.04% (4.58%)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a8722042522559-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a8722042522559-1">Baseline: 86.04% (4.58%)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Using Dropout on the Visible Layer</h2>
<p>Dropout can be applied to input neurons called the visible layer.</p>
<p>In the example below we add a new Dropout layer between the input (or visible layer) and the first hidden layer. The dropout rate is set to 20%, meaning one in 5 inputs will be randomly excluded from each update cycle.</p>
<p>Additionally, as recommended in the original paper on Dropout, a constraint is imposed on the weights for each hidden layer, ensuring that the maximum norm of the weights does not exceed a value of 3. This is done by setting the kernel_constraint argument on the Dense class when constructing the layers.</p>
<p>The learning rate was lifted by one order of magnitude and the momentum was increase to 0.9. These increases in the learning rate were also recommended in the original Dropout paper.</p>
<p>Continuing on from the baseline example above, the code below exercises the same network with input dropout.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a8725973220789" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># dropout in the input layer with weight constraint
def create_model():
	# create model
	model = Sequential()
	model.add(Dropout(0.2, input_shape=(60,)))
	model.add(Dense(60, kernel_initializer='normal', activation='relu', kernel_constraint=maxnorm(3)))
	model.add(Dense(30, kernel_initializer='normal', activation='relu', kernel_constraint=maxnorm(3)))
	model.add(Dense(1, kernel_initializer='normal', activation='sigmoid'))
	# Compile model
	sgd = SGD(lr=0.1, momentum=0.9, decay=0.0, nesterov=False)
	model.compile(loss='binary_crossentropy', optimizer=sgd, metrics=['accuracy'])
	return model

numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasClassifier(build_fn=create_model, epochs=300, batch_size=16, verbose=0)))
pipeline = Pipeline(estimators)
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)
results = cross_val_score(pipeline, X, encoded_Y, cv=kfold)
print("Visible: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-2">2</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-4">4</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-6">6</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-8">8</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-10">10</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-12">12</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-14">14</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-16">16</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-18">18</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a8725973220789-20">20</div><div class="crayon-num" data-line="crayon-5ac9e983a8725973220789-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a8725973220789-1"><span class="crayon-p"># dropout in the input layer with weight constraint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-2"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-3"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-9"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-10"><span class="crayon-h">	</span><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decay</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nesterov</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-14"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-15"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-16"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-17"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-18"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-19"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StratifiedKFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a8725973220789-20"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoded_Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a8725973220789-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Visible: %.2f%% (%.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example provides a small drop in classification accuracy, at least on a single test run.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a8729354910640" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Visible: 83.52% (7.68%)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a8729354910640-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a8729354910640-1">Visible: 83.52% (7.68%)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Using Dropout on Hidden Layers</h2>
<p>Dropout can be applied to hidden neurons in the body of your network model.</p>
<p>In the example below Dropout is applied between the two hidden layers and between the last hidden layer and the output layer. Again a dropout rate of 20% is used as is a weight constraint&nbsp;on those layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a872b863964282" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># dropout in hidden layers with weight constraint
def create_model():
	# create model
	model = Sequential()
	model.add(Dense(60, input_dim=60, kernel_initializer='normal', activation='relu', kernel_constraint=maxnorm(3)))
	model.add(Dropout(0.2))
	model.add(Dense(30, kernel_initializer='normal', activation='relu', kernel_constraint=maxnorm(3)))
	model.add(Dropout(0.2))
	model.add(Dense(1, kernel_initializer='normal', activation='sigmoid'))
	# Compile model
	sgd = SGD(lr=0.1, momentum=0.9, decay=0.0, nesterov=False)
	model.compile(loss='binary_crossentropy', optimizer=sgd, metrics=['accuracy'])
	return model

numpy.random.seed(seed)
estimators = []
estimators.append(('standardize', StandardScaler()))
estimators.append(('mlp', KerasClassifier(build_fn=create_model, epochs=300, batch_size=16, verbose=0)))
pipeline = Pipeline(estimators)
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)
results = cross_val_score(pipeline, X, encoded_Y, cv=kfold)
print("Hidden: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-2">2</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-4">4</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-6">6</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-8">8</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-10">10</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-12">12</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-14">14</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-16">16</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-18">18</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-20">20</div><div class="crayon-num" data-line="crayon-5ac9e983a872b863964282-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ac9e983a872b863964282-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a872b863964282-1"><span class="crayon-p"># dropout in hidden layers with weight constraint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-2"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-3"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-10"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-11"><span class="crayon-h">	</span><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">decay</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nesterov</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-14">&nbsp;</div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-15"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-16"><span class="crayon-v">estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-17"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-18"><span class="crayon-v">estimators</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'mlp'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-19"><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">estimators</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-20"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StratifiedKFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ac9e983a872b863964282-21"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoded_Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ac9e983a872b863964282-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Hidden: %.2f%% (%.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>We can see that for this problem and for the chosen network configuration that using dropout in the hidden layers did not lift performance. In fact, performance was worse than the baseline.</p>
<p>It is possible that additional training epochs are required or that further tuning is required to the learning rate.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a872e103983648" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Hidden: 83.59% (7.31%)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a872e103983648-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a872e103983648-1">Hidden: 83.59% (7.31%)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Tips For Using Dropout</h2>
<p>The original paper on Dropout provides experimental results on a suite of standard machine learning problems. As a result they provide a number of useful heuristics to consider when using dropout in practice.</p>
<ul>
<li>Generally, use a small dropout value of 20%-50% of neurons with 20% providing a good starting point. A probability too low has minimal effect and a value too high results in under-learning by the network.</li>
<li>Use a larger network. You are likely to get better performance when dropout is used on a larger network, giving the model more of an opportunity to learn independent representations.</li>
<li>Use dropout on incoming (visible) as well as hidden units. Application of dropout at each layer of the network has shown good results.</li>
<li>Use a large learning rate with decay and a large momentum. Increase your learning rate by a factor of 10 to 100 and use a high momentum value of 0.9 or 0.99.</li>
<li>Constrain the size of network weights. A large learning rate can result in very large network weights. Imposing a constraint on the size of network weights such as max-norm regularization with a size of 4 or 5 has been shown to improve results.</li>
</ul>
<h2>More Resources on Dropout</h2>
<p>Below are some resources that you can use to learn more about dropout in neural network and deep learning models.</p>
<ul>
<li><a href="http://jmlr.org/papers/v15/srivastava14a.html">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a>&nbsp;(original paper).</li>
<li><a href="http://arxiv.org/abs/1207.0580">Improving neural networks by preventing co-adaptation of feature detectors</a>.</li>
<li><a href="https://www.quora.com/How-does-the-dropout-method-work-in-deep-learning">How does the dropout method work in deep learning?</a> on Quora.</li>
</ul>
<h2>Summary</h2>
<p>In this post, you discovered the dropout regularization technique for deep learning models. You learned:</p>
<ul>
<li>What dropout is and how it works.</li>
<li>How you can use dropout on your own deep learning models.</li>
<li>Tips for getting the best results from dropout on your own models.</li>
</ul>
<p>Do you have any questions about dropout or about this post? Ask your questions in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35">			<div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/"><img style="border: 0;" src="./drop_out_files/DeepLearningWithPython-220.png" alt="Deep Learning with Python" align="left"></a></p>
<h4 style="text-align: center;">&nbsp;What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br>
<em>Multilayer Perceptrons</em>,&nbsp;<em>Convolutional Nets</em> and&nbsp;<em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just&nbsp;Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to&nbsp;learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
		</div></div><div class="apss-social-share apss-theme-4 clearfix">


				<div class="apss-twitter apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://twitter.com/intent/tweet?text=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fdropout-regularization-deep-learning-models-keras%2F&amp;&#39;);" href="javascript:void(0);" title="Share on Twitter" target="">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-twitter"></i>
							<span class="apss-social-text">Share on Twitter</span><span class="apss-share">Tweet</span>
						</div>
											</a>
				</div>
								<div class="apss-facebook apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&#39;);" title="Share on Facebook" target="" href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-facebook"></i>
							<span class="apss-social-text">Share on Facebook</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				
				<div class="apss-linkedin apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;http://www.linkedin.com/shareArticle?mini=true&amp;title=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&amp;summary=A+simple+and+powerful+regularization+technique+for+neural+networks+and+deep+learning+models+is+dropo...&#39;);" title="Share on LinkedIn" target="" href="http://www.linkedin.com/shareArticle?mini=true&amp;title=Dropout%20Regularization%20in%20Deep%20Learning%20Models%20With%20Keras&amp;url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&amp;summary=A+simple+and+powerful+regularization+technique+for+neural+networks+and+deep+learning+models+is+dropo...">
						<div class="apss-icon-block clearfix"><i class="fa fa-linkedin"></i>
							<span class="apss-social-text">Share on LinkedIn</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
								<div class="apss-google-plus apss-single-icon">
					<a rel="nofollow" onclick="apss_open_in_popup_window(event, &#39;https://plus.google.com/share?url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/&#39;);" title="Share on Google Plus" target="" href="https://plus.google.com/share?url=https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">
						<div class="apss-icon-block clearfix">
							<i class="fa fa-google-plus"></i>
							<span class="apss-social-text">Share on Google Plus</span>
							<span class="apss-share">Share</span>
						</div>
											</a>
				</div>
				</div>	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, Ph.D. is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="prev"><i class="fa fa-angle-left"></i> Display Deep Learning Model Training History in Keras</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/tour-weka-machine-learning-workbench/" rel="next">A Tour of the Weka Machine Learning Workbench <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">49 Responses to <em>Dropout Regularization in Deep Learning Models With Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-363832" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-363832" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/fe5b873d0e893c27fbb6a8e7e4d01bcf" srcset="https://secure.gravatar.com/avatar/fe5b873d0e893c27fbb6a8e7e4d01bcf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sheinis</span>
	                <span class="date">September 7, 2016 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-363832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>thanks for the very useful examples!!<br>
Question: the goal of the dropouts is to reduce the risk of overfitting right?<br>
I am wondering whether the accuracy is the best way to measure this; here you are already doing a cross validation, which is by itself a way to reduce overfitting. As you are performing cross-validation *and* dropout, isn’t this somewhat overkill? Maybe the drop in accuracy is actually a drop in amount of information available?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-363832" onclick="return addComment.moveForm( &quot;comment-363832&quot;, &quot;363832&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to sheinis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363857" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-363857" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 7, 2016 at 10:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-363857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>Yes dropout is a technique to reduce the overfitting of the network to the training data.</p>
<p>k-fold cross-validation is a robust technique to estimate the skill of a model. It is well suited to determine whether a specific network configuration has over or under fit the problem.</p>
<p>You could also look at diagnostic plots of loss over epoch on the training and validation datasets to determine how overlearning has been affected by different dropout configurations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-363857" onclick="return addComment.moveForm( &quot;comment-363857&quot;, &quot;363857&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365322" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-365322" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/40e39b9d269efd9e658737191b3cb9a3" srcset="https://secure.gravatar.com/avatar/40e39b9d269efd9e658737191b3cb9a3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aditya</span>
	                <span class="date">September 23, 2016 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-365322" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very good post . Just one question why the need for increasing the learning rate in combination with setting max norm value?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-365322" onclick="return addComment.moveForm( &quot;comment-365322&quot;, &quot;365322&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Aditya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365386" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-365386" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2016 at 8:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-365386" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question. Perhaps less nodes being updated with dropout requires more change/update each batch.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-365386" onclick="return addComment.moveForm( &quot;comment-365386&quot;, &quot;365386&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-367055" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-367055" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/529fdb4cb0ac87956c362be5daa574ac" srcset="https://secure.gravatar.com/avatar/529fdb4cb0ac87956c362be5daa574ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Star</span>
	                <span class="date">October 13, 2016 at 1:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-367055" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The lstm performs well among the training dataset, while does not do well in the testing dataset, i.e. prediction. Could you give me some advice for this problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-367055" onclick="return addComment.moveForm( &quot;comment-367055&quot;, &quot;367055&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Star">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-367110" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-367110" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2016 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-367110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It sounds like overlearning.</p>
<p>Consider using a regularization technique like dropout discussed in this post above.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-367110" onclick="return addComment.moveForm( &quot;comment-367110&quot;, &quot;367110&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-369056" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-369056" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/dffb490febf85825bd9f4399e1c79673" srcset="https://secure.gravatar.com/avatar/dffb490febf85825bd9f4399e1c79673?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yuanliang Meng</span>
	                <span class="date">November 2, 2016 at 7:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-369056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Some people mentioned that applying dropout on the LSTM units often leads to bad results. An example is here: <a href="https://arxiv.org/abs/1508.03720" rel="nofollow">https://arxiv.org/abs/1508.03720</a></p>
<p>I wonder if anyone has any comment on this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-369056" onclick="return addComment.moveForm( &quot;comment-369056&quot;, &quot;369056&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Yuanliang Meng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-369076" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-369076" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2016 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-369076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the link Yuanliang. I do often see worse results. Although, I often see benefit of dropout on the dense layer before output.</p>
<p>My advice is to experiment on your problem and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-369076" onclick="return addComment.moveForm( &quot;comment-369076&quot;, &quot;369076&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-373936" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-373936" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/7939987255a122c0148e6e9a831aaaa0" srcset="https://secure.gravatar.com/avatar/7939987255a122c0148e6e9a831aaaa0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Happy</span>
	                <span class="date">December 6, 2016 at 1:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-373936" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
First of all, thanks to you for making machine learning fun to learn.</p>
<p>I have a query related to drop-outs.<br>
Can we use drop-out even in case we have selected the optimizer as adam and not sgd?<br>
In the examples, sgd is being used and also in the tips section, it has been mentioned ”<br>
Use a large learning rate with decay and a large momentum.”  As far as I see adam does not have the momentum. So what should be the parameter to adam if we use dropouts.</p>
<p>keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.999, epsilon=1e-08, decay=0.0)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-373936" onclick="return addComment.moveForm( &quot;comment-373936&quot;, &quot;373936&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Happy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-374003" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-374003" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2016 at 9:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-374003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can use dropout with other optimization algorithms. I would suggest experimenting with the parameters and see how to balance learning and regularization provided by dropout.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-374003" onclick="return addComment.moveForm( &quot;comment-374003&quot;, &quot;374003&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384442" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-384442" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/db015de93a5653d51295570f25580bc7" srcset="https://secure.gravatar.com/avatar/db015de93a5653d51295570f25580bc7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dalila</span>
	                <span class="date">January 27, 2017 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384442" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In addition to sampling, how does one deal with rare events when building a Deep Learning Model?<br>
For shallow Machine Learning, I can add a utility or a cost function, but here I’m to see if a more elegant approach has been developed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384442" onclick="return addComment.moveForm( &quot;comment-384442&quot;, &quot;384442&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to dalila">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384507" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-384507" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384507" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may also oversample the rare events, perhaps with data augmentation (randomness) to make them look different.</p>
<p>There’s some discussion of handling imbalanced datasets here that might inspire:<br>
<a href="http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384507" onclick="return addComment.moveForm( &quot;comment-384507&quot;, &quot;384507&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384991" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-384991" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/cefcf5cc7a0d1b625a85b7d6b3b9b05c" srcset="https://secure.gravatar.com/avatar/cefcf5cc7a0d1b625a85b7d6b3b9b05c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.tensorflowhub.org/" rel="external nofollow" class="url">Junaid Effendi</a></span>
	                <span class="date">January 30, 2017 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384991" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Why Dropout will work in these cases? It can lower down the computations but how will it impact the increase… i have been experimenting with the dropout on ANN and now on RNN (LSTM), I am using the dropout in LSTM only in the input and output not between the recurrent layers.. but the accuracy remains the same for both validation and training data set…</p>
<p>Any comments ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-384991" onclick="return addComment.moveForm( &quot;comment-384991&quot;, &quot;384991&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Junaid Effendi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385395" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-385395" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-385395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Junaid,</p>
<p>I have not used dropout on RNNs myself.</p>
<p>Perhaps you need more drop-out and less training to impact the skill or generalization capability of your network.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-385395" onclick="return addComment.moveForm( &quot;comment-385395&quot;, &quot;385395&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-396556" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396556" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/881f4d46c6d1d1f458831cb7ae591b03" srcset="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shin</span>
	                <span class="date">April 15, 2017 at 11:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-396556" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is the dropout layer stored in the model when it is stored?.. </p>
<p>If so why?.. it doesn’t make sense to have a dropout layer in a model? besides when training?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-396556" onclick="return addComment.moveForm( &quot;comment-396556&quot;, &quot;396556&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Shin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396586" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-396586" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 16, 2017 at 9:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-396586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a function with no weights. There is nothing to store, other than the fact that it exists in a specific point in the network topology.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-396586" onclick="return addComment.moveForm( &quot;comment-396586&quot;, &quot;396586&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-397054" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-397054" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/788b8655b8ad71cd6fda995e14f09959" srcset="https://secure.gravatar.com/avatar/788b8655b8ad71cd6fda995e14f09959?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">QW</span>
	                <span class="date">April 21, 2017 at 12:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-397054" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it recommended in real practice to fix a random seed for training?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-397054" onclick="return addComment.moveForm( &quot;comment-397054&quot;, &quot;397054&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to QW">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-397095" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-397095" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2017 at 8:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-397095" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see two options, to fix the random seed and make the code reproducible or to run the model n times (30?) and take the mean performance from all runs.</p>
<p>The latter is more robust.</p>
<p>For more on the stochastic nature of machine learning algorithms like neural nets see this post:<br>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-397095" onclick="return addComment.moveForm( &quot;comment-397095&quot;, &quot;397095&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402160" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-402160" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/95577e4128ca28bd74d9078e828fbdf9" srcset="https://secure.gravatar.com/avatar/95577e4128ca28bd74d9078e828fbdf9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.punitsingh.ml/" rel="external nofollow" class="url">Punit Singh</a></span>
	                <span class="date">June 11, 2017 at 4:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am a beginner in Machine Learning and trying to learn neural networks from your blog.<br>
In this post, I understand all the concepts of dropout, but the use of:<br>
from sklearn.model_selection import cross_val_score<br>
from sklearn.model_selection import StratifiedKFold<br>
from sklearn.preprocessing import StandardScaler<br>
from sklearn.pipeline import Pipeline<br>
is making code difficult for me to understand. Would you suggest any way so that I can code without using these?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402160" onclick="return addComment.moveForm( &quot;comment-402160&quot;, &quot;402160&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Punit Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402182" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-402182" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 11, 2017 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can use keras directly. I offer many tutorials on the topic, try the search feature at the top of the page.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402182" onclick="return addComment.moveForm( &quot;comment-402182&quot;, &quot;402182&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402982" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-402982" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/7e27af22a567c6f5791d053052dae57f" srcset="https://secure.gravatar.com/avatar/7e27af22a567c6f5791d053052dae57f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yitzhak</span>
	                <span class="date">June 18, 2017 at 8:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402982" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks Jason, this is so useful !!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-402982" onclick="return addComment.moveForm( &quot;comment-402982&quot;, &quot;402982&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Yitzhak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403026" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-403026" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 19, 2017 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-403026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-403026" onclick="return addComment.moveForm( &quot;comment-403026&quot;, &quot;403026&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405396" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-405396" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/d2866c2a22b4f40df8f19d1832d43198" srcset="https://secure.gravatar.com/avatar/d2866c2a22b4f40df8f19d1832d43198?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Corina</span>
	                <span class="date">July 10, 2017 at 6:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for the awesome materials you provide!<br>
I have a question, I saw that when using dropout for the hidden layers, you applied it for all of them.<br>
My question is, if dropout is applied to the hidden layers then, should it be applied to all of them? Or better yet how do we choose where to apply the dropout?<br>
Thanks  ! <img draggable="false" class="emoji" alt="🙂" src="./drop_out_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405396" onclick="return addComment.moveForm( &quot;comment-405396&quot;, &quot;405396&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Corina">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405476" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-405476" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question. I would recommend testing every variation you can think of for your network and see what works best on your specific problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405476" onclick="return addComment.moveForm( &quot;comment-405476&quot;, &quot;405476&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-405403" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-405403" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 10, 2017 at 8:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405403" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My cat dog classifier with Keras is over-fitting for Dog. How do I make it unbiased?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405403" onclick="return addComment.moveForm( &quot;comment-405403&quot;, &quot;405403&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Dikshika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405480" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-405480" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider augmentation on images in the cat class in order to fit a more robust model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-405480" onclick="return addComment.moveForm( &quot;comment-405480&quot;, &quot;405480&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406205" class="comment even depth-3 parent">

	      	<div id="li-comment-406205" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 17, 2017 at 2:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have already augmented the train data set. But it’s not helping. Here is my code snippet.<br>
It classifies appx 246 out of 254 dogs and 83 out of 246 cats correctly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406205" onclick="return addComment.moveForm( &quot;comment-406205&quot;, &quot;406205&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Dikshika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406294" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-406294" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2017 at 8:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406294" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have good advice off the cuff.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406294" onclick="return addComment.moveForm( &quot;comment-406294&quot;, &quot;406294&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-406206" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-406206" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 17, 2017 at 2:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>from keras.preprocessing.image import ImageDataGenerator<br>
from keras.models import Sequential<br>
from keras.layers import Conv2D, MaxPooling2D<br>
from keras.layers import Activation, Dropout, Flatten, Dense<br>
from keras import backend as K</p>
<p># dimensions of our images.<br>
img_width, img_height = 150, 150</p>
<p>train_data_dir = r’E:\\Interns ! Projects\\Positive Integers\\CatDogKeras\\data\\train’<br>
validation_data_dir = r’E:\\Interns ! Projects\\Positive Integers\\CatDogKeras\\data\\validation’<br>
nb_train_samples = 18000<br>
nb_validation_samples = 7000<br>
epochs = 20<br>
batch_size = 144</p>
<p>if K.image_data_format() == ‘channels_first’:<br>
    input_shape = (3, img_width, img_height)<br>
else:<br>
    input_shape = (img_width, img_height, 3)</p>
<p>model = Sequential()<br>
model.add(Conv2D(32, (3, 3), input_shape=input_shape))<br>
model.add(Activation(‘relu’))<br>
model.add(MaxPooling2D(pool_size=(2, 2)))</p>
<p>model.add(Conv2D(64, (3, 3)))<br>
model.add(Activation(‘relu’))<br>
model.add(MaxPooling2D(pool_size=(2, 2)))</p>
<p>model.add(Conv2D(64, (3, 3)))<br>
model.add(Activation(‘relu’))<br>
model.add(MaxPooling2D(pool_size=(2, 2)))</p>
<p>model.add(Flatten())<br>
model.add(Dense(128))<br>
model.add(Activation(‘relu’))<br>
model.add(Dropout(0.5))<br>
model.add(Dense(1))<br>
model.add(Activation(‘sigmoid’))</p>
<p>model.compile(loss=’binary_crossentropy’,<br>
              optimizer=’rmsprop’,<br>
              metrics=[‘accuracy’])</p>
<p># this is the augmentation configuration we will use for training<br>
train_datagen = ImageDataGenerator(<br>
    rescale=1. / 255,<br>
    shear_range=0.2,<br>
    zoom_range=0.2,<br>
    horizontal_flip=True)</p>
<p># this is the augmentation configuration we will use for testing:<br>
# only rescaling<br>
test_datagen = ImageDataGenerator(rescale=1. / 255)</p>
<p>train_generator = train_datagen.flow_from_directory(<br>
    train_data_dir,<br>
    target_size=(img_width, img_height),<br>
    batch_size=batch_size,<br>
    class_mode=’binary’)</p>
<p>validation_generator = test_datagen.flow_from_directory(<br>
    validation_data_dir,<br>
    target_size=(img_width, img_height),<br>
    batch_size=batch_size,<br>
    class_mode=’binary’)</p>
<p>model.fit_generator(<br>
    train_generator,<br>
    steps_per_epoch=nb_train_samples // batch_size,<br>
    epochs=epochs,<br>
    validation_data=validation_generator,<br>
    validation_steps=nb_validation_samples // batch_size)</p>
<p>input(“Press enter to exit”)</p>
<p>model.save_weights(‘first_try_v2.h5’)</p>
<p>model.save(‘DogCat_v2.h5’)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406206" onclick="return addComment.moveForm( &quot;comment-406206&quot;, &quot;406206&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Dikshika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-406219" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-406219" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 17, 2017 at 6:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406219" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Also, is it possible to get the probability of each training sample after the last epoch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406219" onclick="return addComment.moveForm( &quot;comment-406219&quot;, &quot;406219&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Dikshika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406295" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-406295" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2017 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406295" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, make a probability prediction for each sample at the end of each epoch:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ac9e983a9dbf597697094" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">results = model.predict_proba(X)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ac9e983a9dbf597697094-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ac9e983a9dbf597697094-1"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406295" onclick="return addComment.moveForm( &quot;comment-406295&quot;, &quot;406295&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406330" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-406330" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 18, 2017 at 2:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot. This blog and your suggestions have been really helpful.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406330" onclick="return addComment.moveForm( &quot;comment-406330&quot;, &quot;406330&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Dikshika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406343" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-406343" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2017 at 5:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome, I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406343" onclick="return addComment.moveForm( &quot;comment-406343&quot;, &quot;406343&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-406371" class="comment odd alt depth-5">

	      	<div id="li-comment-406371" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/24d9e2301383e53a3e6b72d6acdc97c3" srcset="https://secure.gravatar.com/avatar/24d9e2301383e53a3e6b72d6acdc97c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dikshika</span>
	                <span class="date">July 18, 2017 at 9:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406371" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am struck here. I am using binary cross entropy. I want to see probabilities as the actual ones between 0 and 1. But I am getting only maximum probabilities, ie, 0 or 1. For both test and training samples.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-406435" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-406435" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2017 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-406435" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use softmax on the output layer and call predict_proba() to get probabilities.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-409875" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-409875" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/905913a0c56327ddf56fbd07c8076dd4" srcset="https://secure.gravatar.com/avatar/905913a0c56327ddf56fbd07c8076dd4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thong Bui</span>
	                <span class="date">August 17, 2017 at 4:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-409875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great insights on how dropout works. I have 1 question: what is the difference between adding a dropout layer (like your examples here) and setting the dropout parameter of a layer, for example:</p>
<p>model.add(SimpleRNN(…, dropout=0.5))<br>
model.add(LSTM(…, dropout=0.5))</p>
<p>Thanks again for sharing your knowledge with us.</p>
<p>Thong Bui</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-409875" onclick="return addComment.moveForm( &quot;comment-409875&quot;, &quot;409875&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Thong Bui">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409907" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-409907" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 17, 2017 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-409907" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nothing really, they are equivalent.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-409907" onclick="return addComment.moveForm( &quot;comment-409907&quot;, &quot;409907&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-411943" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-411943" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/51a4833f6219f8fec7182a2fba2fb392" srcset="https://secure.gravatar.com/avatar/51a4833f6219f8fec7182a2fba2fb392?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Guillaume</span>
	                <span class="date">August 31, 2017 at 11:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-411943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for your tutorials <img draggable="false" class="emoji" alt="🙂" src="./drop_out_files/1f642.svg"></p>
<p>I have a question considering the implementation of the dropout.</p>
<p>I am using an LSTM to predict values of a sin wave. Without, the NN is able to catch quite correctly the frequency and the amplitude of the signal.</p>
<p>However, implementing dropout like this:</p>
<p>model = Sequential()<br>
model.add(LSTM(neuron, input_shape=(1,1)))<br>
model.add(Dropout(0.5))<br>
model.add(Dense(1))</p>
<p>does not lead to the same results as with:</p>
<p>model = Sequential()<br>
model.add(LSTM(neuron, input_shape=(1,1), dropout=0.5))<br>
model.add(Dense(1))</p>
<p>In the first case, the results are also great. But in the second, the amplitude is reduce by 1/4 of its original value..<br>
Any idea why ?</p>
<p>Thank you !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-411943" onclick="return addComment.moveForm( &quot;comment-411943&quot;, &quot;411943&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Guillaume">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-411996" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-411996" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 1, 2017 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-411996" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would think that they are the same thing, I guess my intuition is wrong.</p>
<p>I’m not sure what is going on.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-411996" onclick="return addComment.moveForm( &quot;comment-411996&quot;, &quot;411996&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414881" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-414881" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/d55bb6a4519ac6baffec491ac2a4a900" srcset="https://secure.gravatar.com/avatar/d55bb6a4519ac6baffec491ac2a4a900?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">September 27, 2017 at 3:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for all your posts, they are great! </p>
<p>My main question is a general one about searching for optimal hyper-parameters; is there a methodology you prefer (i.e. sklearn’s grid/random search methods)? Or do you generally just plug and chug? </p>
<p>In addition, I found this code online and had a number of questions on best practices that I think everyone here could benefit from:</p>
<p>”’<br>
model = Sequential()</p>
<p># Input layer with dimension 1 and hidden layer i with 128 neurons.<br>
model.add(Dense(128, input_dim=1, activation=’relu’))<br>
# Dropout of 20% of the neurons and activation layer.<br>
model.add(Dropout(.2))<br>
model.add(Activation(“linear”))<br>
# Hidden layer j with 64 neurons plus activation layer.<br>
model.add(Dense(64, activation=’relu’))<br>
model.add(Activation(“linear”))<br>
# Hidden layer k with 64 neurons.<br>
model.add(Dense(64, activation=’relu’))<br>
# Output Layer.<br>
model.add(Dense(1))</p>
<p># Model is derived and compiled using mean square error as loss<br>
# function, accuracy as metric and gradient descent optimizer.<br>
model.compile(loss=’mse’, optimizer=’adam’, metrics=[“accuracy”])</p>
<p># Training model with train data. Fixed random seed:<br>
numpy.random.seed(3)<br>
model.fit(X_train, y_train, nb_epoch=256, batch_size=2, verbose=2) ”’</p>
<p>1) I was under the impression that the input layer should be the number of features (i.e. columns – 1) in the data, but this code defines it as 1. </p>
<p>2) defining the activation function twice for each layer seems odd to me, but maybe I am misunderstanding the code, but doesn’t this just overwrite the previously defined activation function. </p>
<p>3) For regression problems, shouldn’t the last activation function (before the output layer) be linear?</p>
<p>Source: <a href="http://gonzalopla.com/deep-learning-nonlinear-regression/#comment-290" rel="nofollow">http://gonzalopla.com/deep-learning-nonlinear-regression/#comment-290</a> </p>
<p>Thanks again for all the great posts!<br>
James</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414881" onclick="return addComment.moveForm( &quot;comment-414881&quot;, &quot;414881&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414902" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-414902" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2017 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I use grid searching myself. I try to be as systematic as possible, see here:<br>
<a href="https://machinelearningmastery.com/plan-run-machine-learning-experiments-systematically/" rel="nofollow">https://machinelearningmastery.com/plan-run-machine-learning-experiments-systematically/</a></p>
<p>Yes, the code you pasted has many problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414902" onclick="return addComment.moveForm( &quot;comment-414902&quot;, &quot;414902&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414993" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-414993" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/126ecbb70db4b332f2ffe5f4f82bfeac" srcset="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Azim</span>
	                <span class="date">September 28, 2017 at 2:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414993" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thanks for the nicely articulated blog. I have a question. Is it that dropout is not applied on the output layer, where we have used softmax function? If so, what is the rationale behind this?</p>
<p>Regards,</p>
<p>Azim</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-414993" onclick="return addComment.moveForm( &quot;comment-414993&quot;, &quot;414993&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Azim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415005" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415005" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2017 at 4:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, we don’t use dropout on output only on input and hidden layers.</p>
<p>The rationale is that we do not want to corrupt the output from the model and in turn the calculation of error.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415005" onclick="return addComment.moveForm( &quot;comment-415005&quot;, &quot;415005&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415296" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415296" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/030f1b5affaf6b4a902cf00247c1e7bf" srcset="https://secure.gravatar.com/avatar/030f1b5affaf6b4a902cf00247c1e7bf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alex</span>
	                <span class="date">October 2, 2017 at 7:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>great explanation, Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415296" onclick="return addComment.moveForm( &quot;comment-415296&quot;, &quot;415296&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415310" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415310" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 2, 2017 at 9:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Alex.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415310" onclick="return addComment.moveForm( &quot;comment-415310&quot;, &quot;415310&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415800" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-415800" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/d61245f74e30f60b1e79423542319e99" srcset="https://secure.gravatar.com/avatar/d61245f74e30f60b1e79423542319e99?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Animesh</span>
	                <span class="date">October 6, 2017 at 10:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415800" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How do I plot this code. I have tried various things but get a different error each time.<br>
What is the correct syntax to plot this code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415800" onclick="return addComment.moveForm( &quot;comment-415800&quot;, &quot;415800&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Animesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415808" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415808" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2017 at 11:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean plot the code?</p>
<p>You can run the code by copying it and pasting it into a new file, saving it with a .py extension and running it with the Python interpreter.</p>
<p>If you are new to Python, I recommend learning some basics of the language first.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-415808" onclick="return addComment.moveForm( &quot;comment-415808&quot;, &quot;415808&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423442" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423442" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/01f00f8b47e0853b30d9bda3e870f224" srcset="https://secure.gravatar.com/avatar/01f00f8b47e0853b30d9bda3e870f224?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saman</span>
	                <span class="date">December 16, 2017 at 3:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-423442" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi<br>
i want to know that emerging any two kernels in convolutional layer is dropout technique?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-423442" onclick="return addComment.moveForm( &quot;comment-423442&quot;, &quot;423442&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Saman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423564" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423564" class="comment-container">

					                <div class="avatar"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(1)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2017 at 8:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-423564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow, can you please restate your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#comment-423564" onclick="return addComment.moveForm( &quot;comment-423564&quot;, &quot;423564&quot;, &quot;respond&quot;, &quot;2580&quot; )" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="2580" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ff140e2638"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1523182017146"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery</h3><span class="left"><img alt="" src="./drop_out_files/1d75d46040c28497f0dee5d8e100db37(2)" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100"></span>
<p>Hi, I'm Jason Brownlee, Ph.D.
<br>
My goal is to make practitioners like YOU awesome at applied machine learning.</p>
<p><a href="https://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="text-6" class="widget widget_text">			<div class="textwidget"><p></p><center><p></p>
<h3>Finally Get Started With Deep Learning</h3>
<p>Sick of the fancy math and need for super computers?<br>
Looking for step-by-step tutorials?<br>
Want end-to-end projects?</p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Get Started With Deep Learning in Python Today!</a><br>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="./drop_out_files/DeepLearningWithPython-220.png"></a><br>
</p></center><p></p>
</div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
		<a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/" title="Your First Machine Learning Project in Python Step-By-Step"><img width="45" height="45" src="./drop_out_files/Your-First-Machine-Learning-Project-in-Python-Step-By-Step-150x150.jpg" class="thumbnail wp-post-image" alt="Your First Machine Learning Project in Python Step-By-Step" title="Your First Machine Learning Project in Python Step-By-Step"></a>		<a title="Your First Machine Learning Project in Python Step-By-Step" href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python Step-By-Step</a>
		<span class="meta">June 10, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"><img width="45" height="45" src="./drop_out_files/Time-Series-Prediction-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras"></a>		<a title="Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras" href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/">Time Series Prediction with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 21, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" title="Multivariate Time Series Forecasting with LSTMs in Keras"><img width="45" height="45" src="./drop_out_files/Line-Plots-of-Air-Pollution-Time-Series-150x150.png" class="thumbnail wp-post-image" alt="Line Plots of Air Pollution Time Series" title="Multivariate Time Series Forecasting with LSTMs in Keras"></a>		<a title="Multivariate Time Series Forecasting with LSTMs in Keras" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/">Multivariate Time Series Forecasting with LSTMs in Keras</a>
		<span class="meta">August 14, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"><img width="45" height="45" src="./drop_out_files/How-to-Setup-a-Python-Environment-for-Machine-Learning-and-Deep-Learning-with-Anaconda-150x150.png" class="thumbnail wp-post-image" alt="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda"></a>		<a title="How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda" href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a>
		<span class="meta">March 13, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" title="Develop Your First Neural Network in Python With Keras Step-By-Step"><img width="45" height="45" src="./drop_out_files/Tour-of-Deep-Learning-Algorithms-150x150.jpg" class="thumbnail wp-post-image" alt="Tour of Deep Learning Algorithms" title="Develop Your First Neural Network in Python With Keras Step-By-Step"></a>		<a title="Develop Your First Neural Network in Python With Keras Step-By-Step" href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/">Develop Your First Neural Network in Python With Keras Step-By-Step</a>
		<span class="meta">May 24, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"><img width="45" height="45" src="./drop_out_files/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras"></a>		<a title="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a>
		<span class="meta">July 26, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"><img width="45" height="45" src="./drop_out_files/Time-Series-Forecasting-with-the-Long-Short-Term-Memory-Network-in-Python-150x150.jpg" class="thumbnail wp-post-image" alt="Time Series Forecasting with the Long Short-Term Memory Network in Python" title="Time Series Forecasting with the Long Short-Term Memory Network in Python"></a>		<a title="Time Series Forecasting with the Long Short-Term Memory Network in Python" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/">Time Series Forecasting with the Long Short-Term Memory Network in Python</a>
		<span class="meta">April 7, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" title="Regression Tutorial with the Keras Deep Learning Library in Python"><img width="45" height="45" src="./drop_out_files/Regression-Tutorial-with-Keras-Deep-Learning-Library-in-Python-150x150.jpg" class="thumbnail wp-post-image" alt="Regression Tutorial with Keras Deep Learning Library in Python" title="Regression Tutorial with the Keras Deep Learning Library in Python"></a>		<a title="Regression Tutorial with the Keras Deep Learning Library in Python" href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/">Regression Tutorial with the Keras Deep Learning Library in Python</a>
		<span class="meta">June 9, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"><img width="45" height="45" src="./drop_out_files/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-150x150.jpg" class="thumbnail wp-post-image" alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" title="Multi-Class Classification Tutorial with the Keras Deep Learning Library"></a>		<a title="Multi-Class Classification Tutorial with the Keras Deep Learning Library" href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a>
		<span class="meta">June 2, 2016</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px;">
		<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"><img width="45" height="45" src="./drop_out_files/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-150x150.jpg" class="thumbnail wp-post-image" alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"></a>		<a title="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a>
		<span class="meta">August 9, 2016</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         <div id="text-49" class="widget widget_text">			<div class="textwidget"><form action="https://www.getdrip.com/forms/387997427/submissions" method="post" data-drip-embedded-form="387997427" data-drip-id="387997427">
<center><p></p>
<h3>Tutorials to Your Inbox</h3>
<p></p></center><p></p>
<p align="center">Discover the latest tutorials<br>
in this weekly machine learning newsletter.</p>
<p></p><center><label for="drip-email">Email: </label> <input id="drip-email" name="fields[email]" type="email" value="" size="25"><br>
<input type="submit" value="Sign Up" data-drip-attribute="sign-up-button"></center><br>
<input type="hidden" name="time_zone" value="Asia/Kolkata"><input type="hidden" name="url" value="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/"><input type="hidden" name="page_title" value="Dropout Regularization in Deep Learning Models With Keras - Machine Learning Mastery"></form>
</div>
		</div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p></p><p>
<a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/about/">About</a>
</p><p></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '9556588';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type="text/javascript" src="./drop_out_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./drop_out_files/scripts.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var frontend_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","ajax_nonce":"2cc327227a"};
/* ]]> */
</script>
<script type="text/javascript" src="./drop_out_files/frontend.js"></script>
<script type="text/javascript" src="./drop_out_files/wp-embed.min.js"></script>
<script async="async" type="text/javascript" src="./drop_out_files/form.js"></script>

<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 18435px;"></div><iframe src="./drop_out_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 629px;"></iframe><iframe src="./drop_out_files/saved_resource(1).html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 629px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image">
    <div id="drip-header-2211" class="drip-header drip-hidden">
      <a href="https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Get Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -394px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: none;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Get Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without the math or fancy degree</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em> email course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
            </div>
            <dl class="no-labels">
              
                <dt>Email Address</dt>
                <dd class="drip-clearfix">
                  
                    <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                    <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                  
                </dd>
              
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: block;">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>